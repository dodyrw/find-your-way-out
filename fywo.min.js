!function(e,t,n){function r(n,o){if(!t[n]){if(!e[n]){var s=typeof require=="function"&&require;if(!o&&s)return s(n,!0);if(i)return i(n,!0);throw new Error("Cannot find module '"+n+"'")}var u=t[n]={exports:{}};e[n][0].call(u.exports,function(t){var i=e[n][1][t];return r(i?i:t)},u,u.exports)}return t[n].exports}var i=typeof require=="function"&&require;for(var o=0;o<n.length;o++)r(n[o]);return r}({1:[function(e,t,n){"use strict";n.parsePosition=function(e){var t=[];if(toString.call(e)!="[object Array]"){e=[e]}e.forEach(function(e){t.push({x:e.x||0,y:e.y||0,width:e.width||10,height:e.height||10,color:e.color||"#000000"})});return t};n.generate=function(e,t){var n=this.parsePosition(t),r=e.getContext("2d");n.forEach(function(e){r.fillStyle=e.color;r.fillRect(e.x,e.y,e.width,e.height)});return e}},{}],2:[function(e,t,n){t.exports={world:{width:600,height:600,actor:{width:10,height:10,color:"#ECF0F1"},out:{width:10,height:10,color:"#27AE60"},blocks:{width:10,height:10,color:"#000000"}},levels:[{blocks:[{x:300,y:290},{x:50,y:60},{x:20,y:30}],actor:{x:300,y:580},out:{x:590,y:300}},{blocks:[{x:1,y:50},{x:20,y:500},{x:300,y:400},{x:490,y:111}],actor:{x:300,y:500},out:{x:590,y:300}}]}},{}],3:[function(e,t,n){!function(){"use strict";function e(e){this.parseConf(e)}e.prototype.parseConf=function(e){if(!e.world||!e.levels){throw new Error("Required params not provided")}this.world=e.world;this.levels=e.levels;this.levels.forEach(function(t){t.actor.width=t.actor.width||e.world.actor.width;t.actor.height=t.actor.height||e.world.actor.height;t.actor.color=t.actor.color||e.world.actor.color;t.out.width=t.out.width||e.world.out.width;t.out.height=t.out.height||e.world.out.height;t.out.color=t.out.color||e.world.out.color;t.blocks.forEach(function(t){t.width=t.width||e.world.blocks.width;t.height=t.height||e.world.blocks.height;t.color=t.color||e.world.blocks.color})})};e.prototype.getLevel=function(e){return this.levels[e-1]};n.init=function(t){return new e(t)}}()},{}],4:[function(e,t,n){t.exports=function(e,t,n,r){var i="x",o="y",s=e.height,u="height",a={x:e.x+e.width/2,y:e.y+e.height/2},l={x:n.x+n.width/2,y:n.y+n.height/2};if(e.moving.x!==0){i="y";o="x";s=e.width;u="width"}if(Math.sqrt(Math.pow(a.x-l.x,2)+Math.pow(a.y-l.y,2))<=(e[u]+n[u])/2){e.isMoving=false;e.hasWon=true;return}if(e.x>=r.width||e.y>=r.height||e.x<=0||e.y<=0){e.hasLost=true;return}t.forEach(function(t){if(t[i]<=e[i]+s&&t[i]>=e[i]-s){var n={x:t.x+t.width/2,y:t.y+t.height/2},r=Math.sqrt(Math.pow(a.x-n.x,2)+Math.pow(a.y-n.y,2));collisionDistance=(e[u]+t[u])/2;if(Math.round(r)<=collisionDistance){e.isMoving=false;e.moving.x=0;e.moving.y=0}}})}},{}],5:[function(e,t,n){"use strict";var r=e("./gameConfiguration"),i=e("./worldGenerator"),o=e("../conf/game"),s=e("game-shell")(),u=e("./aware");var a,l=r.init(o),c={x:0,y:0,width:0,height:0,moving:{x:0,y:0},isMoving:false,hasWon:false,hasLost:false},f=1,h,d,m=5;s.bind("move-left","left","A");s.bind("move-right","right","D");s.bind("move-down","down","S");s.bind("move-up","up","W");function v(e,t){a.clearRect(0,0,600,600);if(!t){return}if(f>o.levels.length){s.paused=true;return}c.x=t.actor.x;c.y=t.actor.y;c.width=t.actor.width;c.height=t.actor.height;c.color=t.actor.color;c.hasWon=false;c.isMoving=false;c.hasLost=false;i.generate(e,t.actor);i.generate(e,t.blocks);i.generate(e,t.out)}s.on("init",function(){d=document.getElementById("fywo");h=l.getLevel(f);a=d.getContext("2d");s.element.appendChild(d);v(d,h)});s.on("tick",function(){if(c.hasWon){h=l.getLevel(++f);v(d,h);return}if(c.hasLost){v(d,h);return}if(c.isMoving){u(c,h.blocks,h.out,o.world);return}if(s.wasDown("move-left")){c.moving.x=-m;c.moving.y=0;c.isMoving=true}else if(s.wasDown("move-right")){c.moving.x=m;c.moving.y=0;c.isMoving=true}else if(s.wasDown("move-up")){c.moving.x=0;c.moving.y=-m;c.isMoving=true}else if(s.wasDown("move-down")){c.moving.x=0;c.moving.y=m;c.isMoving=true}});s.on("render",function(){if(c.isMoving){a.clearRect(c.x,c.y,c.width,c.height);a.fillStyle=c.color;c.x+=c.moving.x;c.y+=c.moving.y;a.fillRect(c.x,c.y,c.width,c.height)}})},{"./worldGenerator":1,"../conf/game":2,"./gameConfiguration":3,"./aware":4,"game-shell":6}],7:[function(e,t,n){var r=e("events");n.isArray=i;n.isDate=function(e){return Object.prototype.toString.call(e)==="[object Date]"};n.isRegExp=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"};n.print=function(){};n.puts=function(){};n.debug=function(){};n.inspect=function(e,t,r,u){var a=[];var l=function(e,t){var n={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};var r={special:"cyan",number:"blue","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"}[t];if(r){return"["+n[r][0]+"m"+e+"["+n[r][1]+"m"}else{return e}};if(!u){l=function(e,t){return e}}function h(e,r){if(e&&typeof e.inspect==="function"&&e!==n&&!(e.constructor&&e.constructor.prototype===e)){return e.inspect(r)}switch(typeof e){case"undefined":return l("undefined","undefined");case"string":var u="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return l(u,"string");case"number":return l(""+e,"number");case"boolean":return l(""+e,"boolean")}if(e===null){return l("null","null")}var d=c(e);var m=t?f(e):d;if(typeof e==="function"&&m.length===0){if(o(e)){return l(""+e,"regexp")}else{var v=e.name?": "+e.name:"";return l("[Function"+v+"]","special")}}if(s(e)&&m.length===0){return l(e.toUTCString(),"date")}var p,w,g;if(i(e)){w="Array";g=["[","]"]}else{w="Object";g=["{","}"]}if(typeof e==="function"){var y=e.name?": "+e.name:"";p=o(e)?" "+e:" [Function"+y+"]"}else{p=""}if(s(e)){p=" "+e.toUTCString()}if(m.length===0){return g[0]+p+g[1]}if(r<0){if(o(e)){return l(""+e,"regexp")}else{return l("[Object]","special")}}a.push(e);var _=m.map(function(t){var n,o;if(e.__lookupGetter__){if(e.__lookupGetter__(t)){if(e.__lookupSetter__(t)){o=l("[Getter/Setter]","special")}else{o=l("[Getter]","special")}}else{if(e.__lookupSetter__(t)){o=l("[Setter]","special")}}}if(d.indexOf(t)<0){n="["+t+"]"}if(!o){if(a.indexOf(e[t])<0){if(r===null){o=h(e[t])}else{o=h(e[t],r-1)}if(o.indexOf("\n")>-1){if(i(e)){o=o.split("\n").map(function(e){return"  "+e}).join("\n").substr(2)}else{o="\n"+o.split("\n").map(function(e){return"   "+e}).join("\n")}}}else{o=l("[Circular]","special")}}if(typeof n==="undefined"){if(w==="Array"&&t.match(/^\d+$/)){return o}n=JSON.stringify(""+t);if(n.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)){n=n.substr(1,n.length-2);n=l(n,"name")}else{n=n.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'");n=l(n,"string")}}return n+": "+o});a.pop();var b=0;var k=_.reduce(function(e,t){b++;if(t.indexOf("\n")>=0)b++;return e+t.length+1},0);if(k>50){_=g[0]+(p===""?"":p+"\n ")+" "+_.join(",\n  ")+" "+g[1]}else{_=g[0]+p+" "+_.join(", ")+" "+g[1]}return _}return h(e,typeof r==="undefined"?2:r)};function i(e){return e instanceof Array||Array.isArray(e)||e&&e!==Object.prototype&&i(e.__proto__)}function o(e){return e instanceof RegExp||typeof e==="object"&&Object.prototype.toString.call(e)==="[object RegExp]"}function s(e){if(e instanceof Date)return true;if(typeof e!=="object")return false;var t=Date.prototype&&f(Date.prototype);var n=e.__proto__&&f(e.__proto__);return JSON.stringify(n)===JSON.stringify(t)}function u(e){return e<10?"0"+e.toString(10):e.toString(10)}var a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function l(){var e=new Date;var t=[u(e.getHours()),u(e.getMinutes()),u(e.getSeconds())].join(":");return[e.getDate(),a[e.getMonth()],t].join(" ")}n.log=function(e){};n.pump=null;var c=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};var f=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e){if(Object.hasOwnProperty.call(e,n))t.push(n)}return t};var h=Object.create||function(e,t){var n;if(e===null){n={__proto__:null}}else{if(typeof e!=="object"){throw new TypeError("typeof prototype["+typeof e+"] != 'object'")}var r=function(){};r.prototype=e;n=new r;n.__proto__=e}if(typeof t!=="undefined"&&Object.defineProperties){Object.defineProperties(n,t)}return n};n.inherits=function(e,t){e.super_=t;e.prototype=h(t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}})};var d=/%[sdj%]/g;n.format=function(e){if(typeof e!=="string"){var t=[];for(var r=0;r<arguments.length;r++){t.push(n.inspect(arguments[r]))}return t.join(" ")}var r=1;var i=arguments;var o=i.length;var s=String(e).replace(d,function(e){if(e==="%%")return"%";if(r>=o)return e;switch(e){case"%s":return String(i[r++]);case"%d":return Number(i[r++]);case"%j":return JSON.stringify(i[r++]);default:return e}});for(var u=i[r];r<o;u=i[++r]){if(u===null||typeof u!=="object"){s+=" "+u}else{s+=" "+n.inspect(u)}}return s}},{events:8}],9:[function(e,t,n){var r=t.exports={};r.nextTick=function(){var e=typeof window!=="undefined"&&window.setImmediate;var t=typeof window!=="undefined"&&window.postMessage&&window.addEventListener;if(e){return function(e){return window.setImmediate(e)}}if(t){var n=[];window.addEventListener("message",function(e){if(e.source===window&&e.data==="process-tick"){e.stopPropagation();if(n.length>0){var t=n.shift();t()}}},true);return function r(e){n.push(e);window.postMessage("process-tick","*")}}return function i(e){setTimeout(e,0)}}();r.title="browser";r.browser=true;r.env={};r.argv=[];r.binding=function(e){throw new Error("process.binding is not supported")};r.cwd=function(){return"/"};r.chdir=function(e){throw new Error("process.chdir is not supported")}},{}],8:[function(e,t,n){!function(e){if(!e.EventEmitter)e.EventEmitter=function(){};var t=n.EventEmitter=e.EventEmitter;var r=typeof Array.isArray==="function"?Array.isArray:function(e){return Object.prototype.toString.call(e)==="[object Array]"};function i(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;n++){if(t===e[n])return n}return-1}var o=10;t.prototype.setMaxListeners=function(e){if(!this._events)this._events={};this._events.maxListeners=e};t.prototype.emit=function(e){if(e==="error"){if(!this._events||!this._events.error||r(this._events.error)&&!this._events.error.length){if(arguments[1]instanceof Error){throw arguments[1]}else{throw new Error("Uncaught, unspecified 'error' event.")}return false}}if(!this._events)return false;var t=this._events[e];if(!t)return false;if(typeof t=="function"){switch(arguments.length){case 1:t.call(this);break;case 2:t.call(this,arguments[1]);break;case 3:t.call(this,arguments[1],arguments[2]);break;default:var n=Array.prototype.slice.call(arguments,1);t.apply(this,n)}return true}else if(r(t)){var n=Array.prototype.slice.call(arguments,1);var i=t.slice();for(var o=0,s=i.length;o<s;o++){i[o].apply(this,n)}return true}else{return false}};t.prototype.addListener=function(e,t){if("function"!==typeof t){throw new Error("addListener only takes instances of Function")}if(!this._events)this._events={};this.emit("newListener",e,t);if(!this._events[e]){this._events[e]=t}else if(r(this._events[e])){if(!this._events[e].warned){var n;if(this._events.maxListeners!==undefined){n=this._events.maxListeners}else{n=o}if(n&&n>0&&this._events[e].length>n){this._events[e].warned=true;console.error("(node) warning: possible EventEmitter memory "+"leak detected. %d listeners added. "+"Use emitter.setMaxListeners() to increase limit.",this._events[e].length);console.trace()}}this._events[e].push(t)}else{this._events[e]=[this._events[e],t]}return this};t.prototype.on=t.prototype.addListener;t.prototype.once=function(e,t){var n=this;n.on(e,function r(){n.removeListener(e,r);t.apply(this,arguments)});return this};t.prototype.removeListener=function(e,t){if("function"!==typeof t){throw new Error("removeListener only takes instances of Function")}if(!this._events||!this._events[e])return this;var n=this._events[e];if(r(n)){var o=i(n,t);if(o<0)return this;n.splice(o,1);if(n.length==0)delete this._events[e]}else if(this._events[e]===t){delete this._events[e]}return this};t.prototype.removeAllListeners=function(e){if(arguments.length===0){this._events={};return this}if(e&&this._events&&this._events[e])this._events[e]=null;return this};t.prototype.listeners=function(e){if(!this._events)this._events={};if(!this._events[e])this._events[e]=[];if(!r(this._events[e])){this._events[e]=[this._events[e]]}return this._events[e]}}(e("__browserify_process"))},{__browserify_process:9}],10:[function(e,t,n){var r="",i,o,s;if(window.addEventListener){i="addEventListener"}else{i="attachEvent";r="on"}s="onwheel"in document.createElement("div")?"wheel":document.onmousewheel!==undefined?"mousewheel":"DOMMouseScroll";function u(e,t,n,o){e[i](r+t,s=="wheel"?n:function(e){!e&&(e=window.event);var t={originalEvent:e,target:e.target||e.srcElement,type:"wheel",deltaMode:e.type=="MozMousePixelScroll"?0:1,deltaX:0,delatZ:0,preventDefault:function(){e.preventDefault?e.preventDefault():e.returnValue=false}};if(s=="mousewheel"){t.deltaY=-1/40*e.wheelDelta;e.wheelDeltaX&&(t.deltaX=-1/40*e.wheelDeltaX)}else{t.deltaY=e.detail}return n(t)},o||false)}t.exports=function(e,t,n){u(e,s,t,n);if(s=="DOMMouseScroll"){u(e,"MozMousePixelScroll",t,n)}}},{}],11:[function(e,t,n){var r=0;var i=["ms","moz","webkit","o"];for(var o=0;o<i.length&&!window.requestAnimationFrame;++o){window.requestAnimationFrame=window[i[o]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[i[o]+"CancelAnimationFrame"]||window[i[o]+"CancelRequestAnimationFrame"]}if(!window.requestAnimationFrame)window.requestAnimationFrame=function(e,t){var n=(new Date).getTime();var i=Math.max(0,16-(n-r));var o=window.setTimeout(function(){e(n+i)},i);r=n+i;return o};if(!window.cancelAnimationFrame)window.cancelAnimationFrame=function(e){clearTimeout(e)}},{}],12:[function(e,t,n){if(window.performance.now){t.exports=function(){return window.performance.now()}}else if(window.performance.webktiNow){t.exports=function(){return window.performance.webkitNow()}}else if(Date.now){t.exports=Date.now}else{t.exports=function(){return(new Date).getTime()}}},{}],6:[function(e,t,n){"use strict";var r=e("events").EventEmitter,i=e("util"),o=e("domready"),s=e("vkey"),u=e("invert-hash"),a=e("uniq"),l=e("lower-bound"),c=e("iota-array"),f=Math.min;e("./lib/raf-polyfill.js");var h=e("./lib/mousewheel-polyfill.js");var d=e("./lib/hrtime-polyfill.js");var m=function(){var e=new Array(256),t,n,r;for(t=0;t<256;++t){e[t]="UNK"}for(t in s){r=s[t];if(r.charAt(0)==="<"&&r.charAt(r.length-1)===">"){r=r.substring(1,r.length-1)}r=r.replace(/\s/g,"-");e[parseInt(t)]=r}return e}();var v=a(Object.keys(u(m)));function p(e){var t=l(v,e);if(t<0||t>=v.length){return-1}return t}function w(e){return p(m[e])}function g(){r.call(this);this._curKeyState=new Array(v.length);this._pressCount=new Array(v.length);this._releaseCount=new Array(v.length);this._tickInterval=null;this._rafHandle=null;this._tickRate=0;this._lastTick=d();this._frameTime=0;this._paused=true;this._width=0;this._height=0;this._wantFullscreen=false;this._wantPointerLock=false;this._fullscreenActive=false;this._pointerLockActive=false;this._render=j.bind(undefined,this);for(var e=0;e<v.length;++e){this._curKeyState[e]=false;this._pressCount[e]=this._releaseCount[e]=0}this.element=null;this.bindings={};this.frameSkip=100;this.tickCount=0;this.frameCount=0;this.startTime=d();this.tickTime=this._tickRate;this.frameTime=10;this.stickyFullscreen=false;this.stuckyPointLock=false;this.scroll=[0,0,0];this.mouseX=0;this.mouseY=0;this.prevMouseX=0;this.prevMouseY=0}i.inherits(g,r);var y=g.prototype;y.keyNames=v;y.bind=function(e){var t;if(e in this.bindings){t=this.bindings[e]}else{t=[]}var n;for(var r=1,i=arguments.length;r<i;++r){n=arguments[r];if(p(n)>=0){t.push(n)}else if(n in this.bindings){var o=this.bindings[n];for(var s=0;s<o.length;++s){t.push(o[s])}}}t=a(t);if(t.length>0){this.bindings[e]=t}};y.unbind=function(e){if(e in this.bindings){delete this.bindings[e]}};function _(e,t,n){if(n in t){var r=t[n];for(var i=0,o=r.length;i<o;++i){if(e[p(r[i])]){return true}}return false}var s=p(n);if(s>=0){return e[s]}return false}function b(e,t,n){if(n in t){var r=t[n],i=0;for(var o=0,s=r.length;o<s;++o){i+=e[p(r[o])]}return i}var u=p(n);if(u>=0){return e[u]}return 0}y.down=function(e){return _(this._curKeyState,this.bindings,e)};y.wasDown=function(e){return this.down(e)||!!this.press(e)};y.up=function(e){return!this.down(e)};y.wasUp=function(e){return this.up(e)||!!this.release(e)};y.press=function(e){return b(this._pressCount,this.bindings,e)};y.release=function(e){return b(this._releaseCount,this.bindings,e)};Object.defineProperty(y,"paused",{get:function(){return this._paused},set:function(e){var t=!!e;if(t!==this._paused){if(!this._paused){this._paused=true;this._frameTime=f(1,(d()-this._lastTick)/this._tickRate);clearInterval(this._tickInterval);cancelAnimationFrame(this._rafHandle)}else{this._paused=false;this._lastTick=d()-Math.floor(this._frameTime*this._tickRate);this._tickInterval=setInterval(S,this._tickRate,this);this._rafHandle=requestAnimationFrame(this._render)}}}});function k(e){var t=e.element;if(e._wantFullscreen&&!e._fullscreenActive){var n=t.requestFullscreen||t.requestFullScreen||t.webkitRequestFullscreen||t.webkitRequestFullScreen||t.mozRequestFullscreen||t.mozRequestFullScreen||function(){};n.call(t)}if(e._wantPointerLock&&!e._pointerLockActive){var r=t.requestPointerLock||t.webkitRequestPointerLock||t.mozRequestPointerLock||t.msRequestPointerLock||t.oRequestPointerLock||function(){};r.call(t)}}var x=document.exitFullscreen||document.cancelFullscreen||document.cancelFullScreen||document.webkitCancelFullscreen||document.webkitCancelFullScreen||document.mozCancelFullscreen||document.mozCancelFullScreen||function(){};Object.defineProperty(y,"fullscreen",{get:function(){return this._fullscreenActive},set:function(e){var t=!!e;if(!t){this._wantFullscreen=false;x.call(document)}else{this._wantFullscreen=true;k(this)}return this._fullscreenActive}});function L(e){e._fullscreenActive=document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen||false;if(!e.stickyFullscreen&&e._fullscreenActive){e._wantFullscreen=false}}var E=document.exitPointerLock||document.webkitExitPointerLock||document.mozExitPointerLock||function(){};Object.defineProperty(y,"pointerLock",{get:function(){return this._pointerLockActive},set:function(e){var t=!!e;if(!t){this._wantPointerLock=false;E.call(document)}else{this._wantPointerLock=true;k(this)}return this._pointerLockActive}});function A(e,t){e._pointerLockActive=e.element===(document.pointerLockElement||document.mozPointerLockElement||document.webkitPointerLockElement||null);if(!e.stickyPointerLock&&e._pointerLockActive){e._wantPointerLock=false}}Object.defineProperty(y,"width",{get:function(){return this.element.clientWidth}});Object.defineProperty(y,"height",{get:function(){return this.element.clientHeight}});function M(e,t,n){var r=e._curKeyState[t];if(r!==n){if(n){e._pressCount[t]++}else{e._releaseCount[t]++}e._curKeyState[t]=n}}function S(e){var t=d()+e.frameSkip,n=e._pressCount,r=e._releaseCount,i,o,s,u=e._tickRate,a=v.length;while(!e._paused&&d()>=e._lastTick+u){if(d()>t){e._lastTick=d()+u;return}o=d();e.emit("tick");s=d();e.tickTime=s-o;++e.tickCount;e._lastTick+=u;for(i=0;i<a;++i){n[i]=r[i]=0}if(e._pointerLockActive){e.prevMouseX=e.mouseX=e.width>>1;e.prevMouseY=e.mouseY=e.height>>1}else{e.prevMouseX=e.mouseX;e.prevMouseY=e.mouseY}e.scroll[0]=e.scroll[1]=e.scroll[2]=0}}function j(e){if(e._paused){return}S(e);var t;if(e._paused){t=e._frameTime}else{t=f(1,(d()-e._lastTick)/e._tickRate)}++e.frameCount;var n=d();e.emit("render",t);var r=d();e.frameTime=r-n;requestAnimationFrame(e._render)}function F(e,t){var n=w(t.keyCode||t.char||t.which||t.charCode);if(n>=0){M(e,n,false)}}function C(e,t){var n=w(t.keyCode||t.char||t.which||t.charCode);if(n>=0){M(e,n,true)}}var O=c(32).map(function(e){return p("mouse-"+(e+1))});function P(e,t){for(var n=0;n<32;++n){M(e,O[n],!!(t&1<<n))}}function T(e,t){if(t.buttons!==undefined){P(e,t.buttons)}if(e._pointerLockActive){var n=t.movementX||t.mozMovementX||t.webkitMovementX||0,r=t.movementY||t.mozMovementY||t.webkitMovementY||0;e.mouseX+=n;e.mouseY+=r}else{e.mouseX=t.clientX-e.element.offsetLeft;e.mouseY=t.clientY-e.element.offsetTop}return false}function D(e,t){if(t.buttons===undefined){M(e,O[t.button],true)}else{P(e,t.buttons)}return false}function q(e,t){if(t.buttons===undefined){M(e,O[t.button],false)}else{P(e,t.buttons)}return false}function R(e,t){if(e._pointerLockActive){e.prevMouseX=e.mouseX=e.width>>1;e.prevMouseY=e.mouseY=e.height>>1}else{e.prevMouseX=e.mouseX=t.clientX-e.element.offsetLeft;e.prevMouseY=e.mouseY=t.clientY-e.element.offsetTop}return false}function X(e,t){P(e,0);return false}function z(e,t){var n=1;switch(t.deltaMode){case 0:n=1;break;case 1:n=12;break;case 2:n=e.height;break}e.scroll[0]+=t.deltaX*n;e.scroll[1]+=t.deltaY*n;e.scroll[2]+=t.deltaZ*n||0;return false}function Y(e,t){return false}function N(e,t){var n=v.length,r=e._curKeyState,i=e._releaseCount,o;for(o=0;o<n;++o){if(r[o]){++i[o]}r[o]=false}return false}function I(e,t){var n=e.element.clientWidth|0;var r=e.element.clientHeight|0;if(n!==e._width||r!==e._height){e._width=n;e._height=r;e.emit("resize",n,r)}}function J(){var e=document.createElement("div");e.style.position="absolute";e.style.left="0px";e.style.right="0px";e.style.top="0px";e.style.bottom="0px";e.style.height="100%";e.style.overflow="hidden";document.body.appendChild(e);return e}function K(e){e=e||{};var t=!!e.fullscreen;var n=t;if(typeof e.pointerLock!==undefined){n=!!e.pointerLock}var r=new g;r._tickRate=e.tickRate||30;r.frameSkip=e.frameSkip||(r._tickRate+5)*5;r.stickyFullscreen=!!e.stickyFullscreen||!!e.sticky;r.stickyPointerLock=!!e.stickPointerLock||!e.sticky;if(e.bindings){r.bindings=bindings}setTimeout(function(){o(function i(){var i=e.element;if(typeof i==="string"){var o=document.querySelector(i);if(!o){o=document.getElementById(i)}if(!o){o=document.getElementByClass(i)[0]}if(!o){o=J()}r.element=o}else if(typeof i==="object"&&!!i){r.element=i}else if(typeof i==="function"){r.element=i()}else{r.element=J()}if(r.element.style){r.element.style["-webkit-touch-callout"]="none";r.element.style["-webkit-user-select"]="none";r.element.style["-khtml-user-select"]="none";r.element.style["-moz-user-select"]="none";r.element.style["-ms-user-select"]="none";r.element.style["user-select"]="none"}r._width=r.element.clientWidth;r._height=r.element.clientHeight;var s=I.bind(undefined,r);if(typeof MutationObserver!=="undefined"){var u=new MutationObserver(s);u.observe(r.element,{attributes:true,subtree:true})}else{r.element.addEventListener("DOMSubtreeModified",s,false)}window.addEventListener("resize",s,false);window.addEventListener("keydown",C.bind(undefined,r),true);window.addEventListener("keyup",F.bind(undefined,r),true);r.element.oncontextmenu=Y.bind(undefined,r);r.element.onmousedown=D.bind(undefined,r);r.element.onmouseup=q.bind(undefined,r);r.element.onmousemove=T.bind(undefined,r);r.element.onmouseenter=R.bind(undefined,r);var a=X.bind(undefined,r);r.element.onmouseleave=a;r.element.onmouseout=a;window.addEventListener("mouseleave",a,true);window.addEventListener("mouseout",a,true);var l=N.bind(undefined,r);r.element.onblur=l;window.addEventListener("blur",l,true);h(r.element,z.bind(undefined,r),false);document.body.style.overflow="hidden";document.body.style.height="100%";var c=L.bind(undefined,r);document.addEventListener("fullscreenchange",c,false);document.addEventListener("mozfullscreenchange",c,false);document.addEventListener("webkitfullscreenchange",c,false);r.element.addEventListener("click",k.bind(undefined,r),true);var f=A.bind(undefined,r);document.addEventListener("pointerlockchange",f,false);document.addEventListener("mozpointerlockchange",f,false);document.addEventListener("webkitpointerlockchange",f,false);document.addEventListener("pointerlocklost",f,false);document.addEventListener("webkitpointerlocklost",f,false);document.addEventListener("mozpointerlocklost",f,false);r.fullscreen=t;r.pointerLock=n;r.bind("mouse-left","mouse-1");r.bind("mouse-right","mouse-3");r.bind("mouse-middle","mouse-2");r._lastTick=d();r.startTime=d();r.paused=false;r.emit("init")})},0);return r}t.exports=K},{events:8,util:7,"./lib/mousewheel-polyfill.js":10,"./lib/raf-polyfill.js":11,"./lib/hrtime-polyfill.js":12,domready:13,vkey:14,"invert-hash":15,"lower-bound":16,uniq:17,"iota-array":18}],13:[function(e,t,n){!function(e,n){if(typeof t!="undefined")t.exports=n();else if(typeof define=="function"&&typeof define.amd=="object")define(n);else this[e]=n()}("domready",function(e){var t=[],n,r=false,i=document,o=i.documentElement,s=o.doScroll,u="DOMContentLoaded",a="addEventListener",l="onreadystatechange",c="readyState",f=/^loade|c/.test(i[c]);function h(e){f=1;while(e=t.shift())e()}i[a]&&i[a](u,n=function(){i.removeEventListener(u,n,r);h()},r);s&&i.attachEvent(l,n=function(){if(/^c/.test(i[c])){i.detachEvent(l,n);h()}});return e=s?function(n){self!=top?f?n():t.push(n):function(){try{o.doScroll("left")}catch(t){return setTimeout(function(){e(n)},50)}n()}()}:function(e){f?e():t.push(e)}})},{}],15:[function(e,t,n){"use strict";function r(e){var t={};for(var n in e){if(e.hasOwnProperty(n)){t[e[n]]=n}}return t}t.exports=r},{}],14:[function(e,t,n){!function(){var e=typeof window!=="undefined"?window.navigator.userAgent:"",n=/OS X/.test(e),r=/Opera/.test(e),i=!/like Gecko/.test(e)&&!r;var o,s=t.exports={0:n?"<menu>":"<UNK>",1:"<mouse 1>",2:"<mouse 2>",3:"<break>",4:"<mouse 3>",5:"<mouse 4>",6:"<mouse 5>",8:"<backspace>",9:"<tab>",12:"<clear>",13:"<enter>",16:"<shift>",17:"<control>",18:"<alt>",19:"<pause>",20:"<caps-lock>",21:"<ime-hangul>",23:"<ime-junja>",24:"<ime-final>",25:"<ime-kanji>",27:"<escape>",28:"<ime-convert>",29:"<ime-nonconvert>",30:"<ime-accept>",31:"<ime-mode-change>",27:"<escape>",32:"<space>",33:"<page-up>",34:"<page-down>",35:"<end>",36:"<home>",37:"<left>",38:"<up>",39:"<right>",40:"<down>",41:"<select>",42:"<print>",43:"<execute>",44:"<snapshot>",45:"<insert>",46:"<delete>",47:"<help>",91:"<meta>",92:"<meta>",93:n?"<meta>":"<menu>",95:"<sleep>",106:"<num-*>",107:"<num-+>",108:"<num-enter>",109:"<num-->",110:"<num-.>",111:"<num-/>",144:"<num-lock>",145:"<scroll-lock>",160:"<shift-left>",161:"<shift-right>",162:"<control-left>",163:"<control-right>",164:"<alt-left>",165:"<alt-right>",166:"<browser-back>",167:"<browser-forward>",168:"<browser-refresh>",169:"<browser-stop>",170:"<browser-search>",171:"<browser-favorites>",172:"<browser-home>",173:n&&i?"-":"<volume-mute>",174:"<volume-down>",175:"<volume-up>",176:"<next-track>",177:"<prev-track>",178:"<stop>",179:"<play-pause>",180:"<launch-mail>",181:"<launch-media-select>",182:"<launch-app 1>",183:"<launch-app 2>",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",223:"<meta>",224:"<meta>",226:"<alt-gr>",229:"<ime-process>",231:r?"`":"<unicode>",246:"<attention>",247:"<crsel>",248:"<exsel>",249:"<erase-eof>",250:"<play>",251:"<zoom>",252:"<no-name>",253:"<pa-1>",254:"<clear>"};for(o=58;o<65;++o){s[o]=String.fromCharCode(o)}for(o=48;o<58;++o){s[o]=o-48+""}for(o=65;o<91;++o){s[o]=String.fromCharCode(o)}for(o=96;o<107;++o){s[o]="<num-"+(o-96)+">"}for(o=112;o<136;++o){s[o]="F"+(o-111)}}()},{}],16:[function(e,t,n){"use strict";function r(e,t,n,r,i){r=r|0;i=i|0;while(r<i){var o=r+i>>>1,s=n(t,e[o]);if(s<0){i=o-1}else if(s>0){r=o+1}else{i=o}}if(n(e[r],t)<=0){return r}return r-1}function i(e,t,n,r){n=n|0;r=r|0;while(n<r){var i=n+r>>>1;if(t<e[i]){r=i-1}else if(t>e[i]){n=i+1}else{r=i}}if(e[n]<=t){return n}return n-1}function o(e,t,n,o,s){if(!o){o=0}if(typeof s!=="number"){s=e.length-1}if(n){return r(e,t,n,o,s)}return i(e,t,o,s)}t.exports=o},{}],17:[function(e,t,n){"use strict";function r(e,t){var n=1,r=e.length,i=e[0],o=e[0];for(var s=1;s<r;++s){o=i;i=e[s];if(t(i,o)){if(s===n){n++;continue}e[n++]=i}}e.length=n;return e}function i(e){var t=1,n=e.length,r=e[0],i=e[0];for(var o=1;o<n;++o,i=r){i=r;r=e[o];if(r!==i){if(o===t){t++;continue}e[t++]=r}}e.length=t;return e}function o(e,t,n){if(e.length===0){return[]}if(t){if(!n){e.sort(t)}return r(e,t)}if(!n){e.sort()}return i(e)}t.exports=o},{}],18:[function(e,t,n){"use strict";function r(e){var t=new Array(e);for(var n=0;n<e;++n){t[n]=n}return t}t.exports=r},{}]},{},[5]);